<!DOCTYPE html>
<html xmlns="http://xmlns.jcp.org/jsf/html"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>CO₂-Daten Portal</title>
    <h:outputStylesheet library="css" name="styles.css" />
</h:head>
<h:body>
    <div class="login-panel">
        <h:form id="loginForm">
            <p:panel header="Login">
                <h:panelGrid columns="2" cellpadding="5">
                    <p:outputLabel for="username" value="Benutzer:" />
                    <p:inputText id="username" value="#{mainController.userInput}" required="true" />

                    <p:outputLabel for="password" value="Passwort:" />
                    <p:password id="password" value="#{mainController.passwordInput}" required="true" />
                </h:panelGrid>
                <p:commandButton value="Einloggen"
                               action="#{mainController.login}"
                               update="loginForm messages"
                               style="margin-top:10px;" />
                <p:messages id="messages" showDetail="true" closable="true" />
            </p:panel>
        </h:form>
    </div>

    <div class="data-panel">
        <p:panel header="Aktuelle CO₂-Daten">
            <h:form id="co2Form">
                <p:selectOneMenu value="#{shop.selectedCountry}" style="width:300px">
                    <f:selectItem itemLabel="-- Land auswählen --" itemValue="" />
                    <f:selectItems value="#{shop.countries}" />
                    <p:ajax listener="#{shop.onCountryChange}" update="co2output" />
                </p:selectOneMenu>

                <h:panelGroup id="co2output" styleClass="latest-data">
                    <h:panelGroup rendered="#{not empty shop.currentArtikel}">
                        <div>
                            <h3>#{shop.currentArtikel.land}</h3>
                            <p class="data-value">
                                CO₂-Ausstoß: #{shop.currentArtikel.co2Ausstoss} #{shop.currentArtikel.einheit}
                            </p>
                            <p class="data-date">
                                Stand: #{shop.currentArtikel.jahr}
                                <h:outputText value=" (Aktualisiert am: #{shop.currentArtikel.erstelltAm})">
                                    <f:convertDateTime pattern="dd.MM.yyyy" />
                                </h:outputText>
                            </p>
                            <p>
                                <em>Quelle: #{shop.currentArtikel.beschreibung}</em>
                            </p>
                        </div>
                    </h:panelGroup>
                    <h:panelGroup rendered="#{empty shop.currentArtikel}">
                        <p>Bitte wählen Sie ein Land aus, um die aktuellen CO₂-Daten anzuzeigen.</p>
                    </h:panelGroup>
                </h:panelGroup>
            </h:form>
        </p:panel>
    </div>
</h:body>
</html>
